\documentclass{article}

\usepackage{amsmath,amssymb,amsthm,mathtools}
\usepackage[margin=1in]{geometry}

\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}
\newtheorem{defin}{Definition}

\begin{document}

First let us lay out some definitions.
These should probably be pretty familiar but we want to be extra explicit.

\begin{defin}
A \textbf{well formed formula} (in the \L ukasievicz system) is a statement spanned by the following grammar:
\begin{align*}
S \Coloneqq
& \mid (S \rightarrow S)  \\
& \mid \neg S  \\
& \mid \text{Atom} \\
\end{align*} 
\end{defin}

\begin{defin}
A \textbf{formula} (in the \L ukasievicz system) is a statement spanned by the following grammar:
\begin{align*}
S \Coloneqq
& \mid (S \rightarrow S)  \\
& \mid \neg S  \\
& \mid \text{Atom} \\
& \mid \text{Free Variable} \\
\end{align*} 
\end{defin}

Now in practice there are no limitations on the number of atoms and free variables available but for convenience we will take atoms to be any capital Latin letter and free variables to be any lower case Greek letter.
We will also use capital Greek letters to stand in for complex statments.
For example if we wanted to talk about statements with $\rightarrow$ at the top level we would use the notation $\Phi \rightarrow \Psi$.
This is usually what free variables are used for but because free variables are objects we are concerned with we need to operate at the meta level.
This is purely notational.

\begin{defin}
Two formulae are \textbf{equal} if they are both generated by the same path in the grammar.
\end{defin}

\begin{defin}
The \textbf{assignment} of a formula by some function $f$, that maps free variables to formulae, denoted $A \lhd f$ will be defined as such:
\begin{align*}
(\Phi \rightarrow \Psi) \lhd f &= (\Phi \lhd f \rightarrow \Psi \lhd f) \\
(\neg \Phi) \lhd f &= \neg (\Phi \lhd f) \\
\text{Atom} \lhd f &= \text{Atom} \\
\text{Free Variable} \lhd f &= f(\text{Free Variable}) \\
\end{align*}
\end{defin}

One can think of assignment as applying a function $f$ to every free variable in the formula.
In this way it ``\textit{assigns}" each free variable.

We will now talk about formulae with the language of sets.
This will become useful as we go on.

\begin{defin}
Let a well formed formula $A$ be a \textbf{member} of a formula $B$
if and only if there exists some function $f$ such that the assignment of $B$ by $f$ is equal to $A$.
We will use the usual $\in$ symbol to denote membership.

\begin{align*}
A \in B \iff \exists f: B \lhd f = A
\end{align*}
\end{defin}

\begin{lem}
If $x \in B$ there is exactly one $f$ such that $B \lhd f = x$.
In other words if $B \lhd f = x$ and $B \lhd g = x$ then $f = g$.
\end{lem}
\begin{proof}
We will prove this via structural induction.

For atoms we know that this is the case because atoms don't contain free varaibles and thus the only assignment function is $f : \{\} \mapsto \{\}$.
Since there is only one assignment function it is trivial that there can only be one assignment function.

If we have that $\Phi \in \Psi$ where $\Psi$ is a free variable we know that the only assignment function $f$ such that $\Psi \lhd f = \Phi$ is $f : \{\Phi\} \mapsto \{\Psi\}$.
The domain must be $\{\Psi\}$ because $\Psi$ is the only free variable and it must map to $\Phi$.

Now let us consider that $\neg \Phi \in \neg \Psi$ where we know that there is only one function such that $\Psi \lhd f = \Phi$.
\end{proof}

\begin{defin}
Let the \textbf{intersection} (denoted $\cap$) of two formulae $A$ and $B$ be the set of all well formed formula such that there is an assignment that makes the well formed formula equal to both $A$ and $B$.

\begin{align*}
A \cap B = \left\{x \mid \exists f: (A \lhd f = x \land B \lhd f = x)\right\}
\end{align*}
\end{defin}

Note that the intersection of $A$ and $B$ is \textit{not}

\begin{align*}
\left\{x \mid x \in A \land x \in B\right\}
\end{align*}

the assignment that makes $x$ equal must be the same.

As a counter example

\begin{align*}
\phi \cap (\phi \rightarrow \phi) = \{\}
\end{align*}

despite the fact $(A \rightarrow A)$ is a member of both formulae.

\begin{defin}
A set is \textbf{equivalent} to a formula if every member of the set is a member of the formula and every member of the formula is a member of the set.
\begin{align*}
A \equiv B \iff \forall x: x \in A \leftrightarrow x \in B
\end{align*}
\end{defin}

\begin{lem}
The intersection of two formulae is either the empty set or equivalent to a formula
\begin{align*}
\forall A,B : \left(A \cap B = \left\{\right\} \lor \exists C : A \cap B \equiv C \right)
\end{align*}
\end{lem}
\begin{proof}
This proof will be performed via structural induction.
To start we verify that this is in fact the case for atoms.
And it is $\Phi \cap \Psi$ is the empty set if the atoms are different and is $\Phi$ if the atoms are the same.
This is pretty clear because no assignment can a formula consisting only of an atom.

We can also see that the intersection of two free variables will always be a formula.
Since every statement is a member of a free variable (simply choose an $f$ such that $f$ results in the statemnt when applied to the variable in question),
the result is just another free variable.

Next we can see that if $\Phi \cap \Psi \equiv \Omega$
\begin{align*}
\neg \Phi \cap \neg \Psi \equiv \neg \Omega
\end{align*}
but if $\Phi \cap \Psi = \{\}$ then
\begin{align*}
\neg \Phi \cap \neg \Psi = \{\}
\end{align*}
this means that negation upholds our property.

Lastly we have $\rightarrow$.
$\rightarrow$ is trickier.
We consider
\begin{align*}
(\Phi \rightarrow \Psi) \cap (\Omega \rightarrow \Sigma)
\end{align*}
Now if either $\Phi \cap \Omega = \{\}$ or $\Psi \cap \Sigma = \{\}$ it is clear that the composite statement must be empty.
So we will only consider the case where $\Phi \cap \Omega \equiv \Pi$ and $\Psi \cap \Sigma \equiv \Xi$.

Now if we return to our definitions
\begin{align*}
(\Phi \rightarrow \Psi) \cap (\Omega \rightarrow \Sigma) = \left\{x\mid\exists f:(\Phi \rightarrow \Psi)\lhd f = x \land (\Omega \rightarrow \Sigma) \lhd f = x\right\}
\end{align*}
\end{proof}

\begin{thm}
There is no proof of $A \rightarrow A$ in the \L ukasiewicz system that is less than 5 steps long.
\end{thm}
\begin{proof}
In order to prove that no such proof exists we will attempt to construct such a proof.
We will despite our best efforts fail to do so demonstrating the impossibility of the task.

We will start our proof at the end.
We know that the statement $A \rightarrow A$ must appear in the proof,
and that any steps after it are extraneous and can be removed.
Thus $A \rightarrow A$ must be the last step of the proof.
We will label this step $\alpha$

\begin{align*}
A \rightarrow A \tag*{($\alpha$)}\\
\end{align*}

We also know that $A \rightarrow A$ does not fit the form of any of our axioms.
This means that we must have arrived at it from modus ponens.

\begin{align*}
A \rightarrow A \tag*{Modus Ponens ($\alpha$)}\\
\end{align*}

Since we arrived at this from modus ponens we know that there must be earlier statements of the form $\phi$ and $\phi \rightarrow (A \rightarrow A)$.
Since all statements are finite we also know that there is no $\phi$ such that

\begin{align*}
\phi = \phi \rightarrow (A \rightarrow A)
\end{align*}

Thus the two statements must be separate.

\begin{gather*}
\phi \tag{$\gamma$}\\
\phi \rightarrow (A \rightarrow A) \tag{$\beta$}\\
A \rightarrow A \tag*{Modus Ponens ($\alpha$)}\\
\end{gather*}

We can express $\phi \rightarrow (A \rightarrow A)$ as a statement of L.S.1 if $\phi = A$,
however doing so would mean that our proof would need to include a proof of $A$.
Since $A$ clearly is independent of our axioms we know that the statement cannot be a reference to L.S.1.

If we try to write the same statement as L.S.2 we will find it impossible.

\begin{gather*}
\phi \rightarrow (A \rightarrow A) = (\psi \rightarrow (\chi \rightarrow \omega)) \rightarrow ((\psi \rightarrow \chi) \rightarrow (\psi \rightarrow \omega)) \\
\phi = (\psi \rightarrow (\chi \rightarrow \omega)), A \rightarrow A = (\psi \rightarrow \chi) \rightarrow (\psi \rightarrow \omega) \\
\phi = (\psi \rightarrow (\chi \rightarrow \omega)), A = \psi \rightarrow \chi, A = \psi \rightarrow \omega \\
\end{gather*}

Since $A$ cannot be of the form $\psi \rightarrow \chi$ (nor the form $\psi \rightarrow \omega$) there is no instantiation of L.S.2 of the form $\phi \rightarrow (A \rightarrow A)$.

If we set $\phi$ equal to $\neg A \rightarrow \neg A$ we will find that L.S.3 allows us to conclude our statement.

\begin{gather*}
\neg A \rightarrow \neg A \tag{$\gamma$}\\
(\neg A \rightarrow \neg A) \rightarrow (A \rightarrow A) \tag*{L.S.3 ($\beta$)} \\
A \rightarrow A \tag*{Modus Ponens ($\alpha$)}\\
\end{gather*}

Now using the same thought process as $A \rightarrow A$ we can show that $\neg A \rightarrow \neg A$ must be derived via modus ponens.
This gives us a proof of the form:

\begin{gather*}
\psi \tag{$\eta$}\\
\psi \rightarrow (\neg A \rightarrow \neg A) \tag{$\delta$} \\
(\neg A \rightarrow \neg A) \rightarrow (A \rightarrow A) \tag*{L.S.3 ($\beta$)} \\
\neg A \rightarrow \neg A \tag*{Modus Ponens ($\gamma$)}\\
A \rightarrow A \tag*{Modus Ponens ($\alpha$)}\\
\end{gather*}

Now since we are looking for a proof with 4 steps we know that it must be the case that $\psi$ is equal to $(\neg A \rightarrow \neg A) \rightarrow (A \rightarrow A)$, otherwise we would have 5 steps.

\begin{gather*}
((\neg A \rightarrow \neg A) \rightarrow (A \rightarrow A)) \rightarrow (\neg A \rightarrow \neg A) \\
(\neg A \rightarrow \neg A) \rightarrow (A \rightarrow A) \tag*{L.S.3} \\
\neg A \rightarrow \neg A \tag*{Modus Ponens}\\
A \rightarrow A \tag*{Modus Ponens}\\
\end{gather*}

Now we need to check whether the first statement can be a instantiation of one of our axioms.
If we check we find that there are no values of $\phi$, $\psi$ and $\chi$ for which the our statement is an instantiation of any of the axioms.

Now we backtrace to the last descision we made.
We chose to represent $\phi \rightarrow (A \rightarrow A)$ as L.S.3.
Since that arrived us at an incorrect conclusion we know that it cannot be the case that in a four step proof that step is introduced by L.S.3.
Since we have removed all of the axioms as possibilites to introduce $\phi \rightarrow (A \rightarrow A)$  we know that it is introduced by modus ponens.

\begin{gather*}
\phi \\
\psi \\
\psi \rightarrow (\phi \rightarrow (A \rightarrow A)) \\
\phi \rightarrow (A \rightarrow A) \tag*{Modus Ponenes} \\
A \rightarrow A \tag*{Modus Ponens}\\
\end{gather*}

Since we have 5 claims here we know that in order to reduce our proof to 4 steps we must have two of them that are equal.
It is clear that no statement containing $\phi$ can be equal to $\phi$ and the same goes for $\psi$.
We also know that if a statement $\chi$ that relies on a statement $\omega$, it must be the case that $\chi \neq \omega$ otherwise our proof would be circular.

Of the remaining statments that could be equal there is only one pair that has the same form.
This leaves us to say that $\phi = \psi$. 

\begin{gather*}
\phi \\
\phi \rightarrow (\phi \rightarrow (A \rightarrow A)) \\
\phi \rightarrow (A \rightarrow A) \tag*{Modus Ponenes} \\
A \rightarrow A \tag*{Modus Ponens}\\
\end{gather*}

Our remaining statements must be instantiations of our axioms because any use of modus ponens would add new steps to the proof.
If we start with the sentence $\phi \rightarrow (\phi \rightarrow (A \rightarrow A))$ we will find it can only be instantiated by L.S.1.

\begin{gather*}
A \rightarrow A \\
(A \rightarrow A) \rightarrow ((A \rightarrow A) \rightarrow (A \rightarrow A)) \tag*{L.S.1} \\
(A \rightarrow A) \rightarrow (A \rightarrow A) \tag*{Modus Ponenes} \\
A \rightarrow A \tag*{Modus Ponens}\\
\end{gather*}

Now in order to make this proof valid we must proof $A \rightarrow A$ in 1 step.
This would require the instantiation of an axiom and we already know that this is impossible.

Thus there is no proof of $A \rightarrow A$ that is 4 steps or shorter.
\end{proof}

\begin{lem}
	Given $\neg A$, there is no proof of $A \rightarrow B$ that is shorter than 4 steps.
\end{lem}
\begin{proof}
	In order to prove that no such proof exists, we will again attempt to construct such a proof.
	We will again start the proof at the end and work backwards toward our premise. Given that $A \rightarrow B$ must appear in the proof, any steps prior to that superfluous and will be disregarded. Thus $A \rightarrow B$ must be the last step. We'll call this step $\alpha$:
	
	\begin{gather*}
	A \rightarrow B \tag*{$(\alpha)$} \\
	\end{gather*}
	
	For my own sake, I went ahead and proved this in as few lines as I could using Fitch, which has the benefit of being robust. In such a system, the proof is 5 lines (including the premise) and includes a simple subproof:
	
	\begin{gather*}
	\neg A \tag*{Premise (1)} \\
	A \tag*{Assumed (2)} \\
	\bot \tag*{$\bot$ Introduction 1,2 (3)} \\
	B \tag*{$\bot$ Elimination 3 (4)} \\
	A \rightarrow B \tag*{$\rightarrow$ Introduction 2-4 (5)} \\
	\end{gather*}
	
	Ergo, whatever we achieve via our axioms may well model this process. Using this thinking as a baseline, we will proceed.
	
	\begin{gather*}
	\neg A \tag*{Premise ($\phi$)} \\
	\neg A \rightarrow (\neg B \rightarrow \neg A) \tag*{L.S.1 $\phi$ ($\delta$)} \\
	\neg B \rightarrow \neg A \tag*{MP $\phi, \delta$ ($\gamma$)} \\
	(\neg B \rightarrow \neg A) \rightarrow (A \rightarrow B) \tag*{L.S.3 $\gamma$ ($\beta$)} \\
	A \rightarrow B \tag*{MP $\gamma, \beta$ ($\alpha$)} \\
	\end{gather*}
	
	This follows logic identical to Lemma 1, arriving at an identical conclusion within 4 steps.
\end{proof}

\begin{lem}
	Given $A \rightarrow B$ and $A \rightarrow C$, we can conclude that $A \rightarrow (B \land C)$ in only [] steps.
\end{lem}
\begin{proof}
	Starting with our conclusion as our final statement:

	\begin{gather*}
	A \rightarrow (B \land C) \tag*{$(\alpha)$} \\
	\end{gather*}
	
	

\end{proof}
\end{document}
